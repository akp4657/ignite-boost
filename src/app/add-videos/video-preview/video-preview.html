<!-- eslint-disable @angular-eslint/template/label-has-associated-control -->
<div class="w-full flex flex-col justify-center p-4 bg-black/75">
    <app-video-embed
        [videoID]="this.urlData()['id']"
        [videoSrc]="this.urlData()['src']"
        class="flex justify-center w-full"
    />
    <div class="video-preview">
        <form class="mt-2 mx-2 flex flex-wrap gap-4 text-white">
            <div class="p-[2px] shadow-xl bg-black">
                <div
                    class="p-[2px] bg-gradient-to-r from-(--player-gradient-ends) via-(--player-gradient-center) to-(--player-gradient-ends)">
                    <mat-form-field class="bg-black p-1">
                        <mat-label>Date</mat-label>
                        <input matInput type="date" (change)="updateDate($event.target.value)" />
                    </mat-form-field>
                </div>
            </div>
            <div class="p-[2px] shadow-xl bg-black video-preview-link grow-1">
                <div
                    class="p-[2px] bg-gradient-to-r from-(--player-gradient-ends) via-(--player-gradient-center) to-(--player-gradient-ends)">
                    <mat-form-field class="bg-black p-1 w-full">
                        <mat-label>Video Link (YouTube, Twitch, Niconico, Bilibili)</mat-label>
                        <input matInput type="url" placeholder="Ex. https://www.youtube.com/watch?v=***********"
                            (change)="parseURL($event.target.value.trim())" [value]="this.urlData().url" />
                    </mat-form-field>
                </div>
            </div>
            <div class="p-[2px] shadow-xl bg-black cursor-pointer" cdkOverlayOrigin #versionSelect>
                <div class="p-[2px] bg-gradient-to-r from-(--player-gradient-ends) via-(--player-gradient-center) to-(--player-gradient-ends)">
                    <mat-form-field class="bg-black p-1 cursor-pointer">
                        <label matformfieldfloatinglabel=""
                            class="mdc-floating-label mat-mdc-floating-label mdc-floating-label--float-above">
                            <mat-label class="mdc-floating-label--float-above">Version</mat-label>
                        </label>
                        <input matInput class="opacity-0"/>
                        <button
                            class="absolute w-full inline-flex left-0 justify-between cursor-pointer"
                            (click)="versionSelOpen.set(!versionSelOpen())"
                            type="button"
                        >
                            <span class="w-full text-left">{{(this.urlData()['version'] === 2) ? 'DFCI' : 'DFC'}}</span>
                            <div class="w-[10px] h-[5px] relative">
                                <mat-icon class="absolute top-1/2 left-1/2 -translate-1/2">arrow_drop_down</mat-icon>
                            </div>
                        </button>
                    </mat-form-field>
                    <ng-template
                        cdkConnectedOverlay
                        [cdkConnectedOverlayOrigin]="versionSelect"
                        [cdkConnectedOverlayOpen]="versionSelOpen()"
                        [cdkConnectedOverlayPositions]="[
                            {
                                originX: 'start',
                                originY: 'bottom',
                                overlayX: 'start',
                                overlayY: 'top',
                            },
                            {
                                originX: 'end',
                                originY: 'bottom',
                                overlayX: 'end',
                                overlayY: 'top',
                            }
                        ]"
                        (detach)="versionSelOpen.set(false)"
                        (overlayOutsideClick)="versionSelOpen.set(false)"
                    >
                        <div
                            class="select-overlay text-white"
                            animate.enter="select-overlay-enter"
                            animate.leave="select-overlay-leave"
                        >
                            <button
                                (click)="updateVersionSelect(1)"
                                [ngClass]="`px-4 py-2 flex gap-4 justify-between items-center w-full cursor-pointer ${this.urlData()['version'] === 1 ? 'bg-(--color-primary)/50': ''} hover:bg-white/25`"
                            >
                                <span class="text-md">DFC</span>
                                <app-image-loader
                                    [src]="'/assets/bolt_dfc.webp'"
                                    [alt]="`dfc icon`"
                                    [width]="90"
                                    [height]="90"
                                    addClass="h-8 w-fit"
                                    spinnerClass="h-8 w-fit"
                                />
                            </button>
                            <button
                                (click)="updateVersionSelect(2)"
                                [ngClass]="`px-4 py-2 flex gap-4 justify-between items-center w-full cursor-pointer ${this.urlData()['version'] === 2 ? 'bg-(--color-primary)/50': ''} hover:bg-white/25`"
                            >
                                <span class="text-md">DFCI</span>
                                <app-image-loader
                                    [src]="'/assets/bolt_dfci.webp'"
                                    [alt]="`dfci icon`"
                                    [width]="90"
                                    [height]="90"
                                    addClass="h-8 w-fit"
                                    spinnerClass="h-8 w-fit"
                                />
                            </button>
                        </div>
                    </ng-template>
                </div>
            </div>
        </form>
    </div>

    <hr class="mt-4" />
</div>
